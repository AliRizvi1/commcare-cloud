DEFAULT_POSTGRESQL_HOST: pgmain0

REPORTING_DATABASES:
  ucr: ucr
  icds-ucr-non-dashboard: icds-ucr-non-dashboard
  icds-ucr:
    WRITE: icds-ucr
    READ:
      - [icds-ucr-standby0, 10]
      - [icds-ucr-standby1, 10]
      - [icds-ucr-standby2, 10]
      - [icds-ucr-standby3, 10]
  icds-test-ucr: icds-ucr
  icds-ucr-citus: icds-ucr-citus

LOAD_BALANCED_APPS:
  auth:
    - [default, 1]
    - [pgmainstandby0, 4]
    - [pgmainstandby1, 4]
    - [pgmainstandby2, 4]
  locations:
    - [default, 1]
    - [pgmainstandby0, 4]
    - [pgmainstandby1, 4]
    - [pgmainstandby2, 4]
  userreports:
    - [default, 1]
    - [pgmainstandby0, 4]
    - [pgmainstandby1, 4]
    - [pgmainstandby2, 4]

pgbouncer_override:
  pgbouncer_pool_mode: transaction
  pgbouncer_pool_timeout: 1
  pgbouncer_reserve_pool: 5

postgres_override:
  postgresql_max_standby_delay: 180s
  postgresql_max_stack_depth: 6MB
  postgresql_slow_log_threshold: 1000
  postgresql_hba_entries:
    - contype: host
      users: hqrepl
      netmask: 100.71.184.0/22
    - contype: host
      users: TCLBKPADMIN
      netmask: 127.0.0.1/32
    - contype: local
      users: TCLBKPADMIN


dbs:
  main:
    host: pgmain0
    query_stats: True
  formplayer:
    host: pgmain0
  ucr:
    host: pgucr
  synclogs:
    host: pgsynclog0
  form_processing:
    proxy:
      host: plproxy0
    partitions:
      p1:
        shards: [0, 103]
        host: pgshard0
      p2:
        shards: [104, 205]
        host: pgshard1standby
      p3:
        shards: [206, 308]
        host: pgshard2
      p4:
        shards: [309, 411]
        host: pgshard3
      p5:
        shards: [412, 514]
        host: pgshard4
      p6:
        shards: [515, 617]
        host: pgshard5standby
      p7:
        shards: [618, 720]
        host: pgshard6
      p8:
        shards: [721, 823]
        host: pgshard7
      p9:
        shards: [824, 926]
        host: pgshard8standby
      p10:
        shards: [927, 1023]
        host: pgshard9
  custom:
    - django_alias: icds-ucr
      name: commcarehq_icds_aggregatedata
      host: pgucr
      query_stats: True
      django_migrate: True  # the dashboard models are stored here
    - django_alias: icds-ucr-non-dashboard
      name: commcarehq_icds_aggregatedata
      host: pgnondashboarducr0
      query_stats: True
      django_migrate: False
    - django_alias: icds-ucr-citus
      name: icds_ucr
      django_migrate: True  # ICDS dashboard models are stored here
      host: citusmaster0
      pg_config:
        - name: citus.shard_count
          value: 64
    - name: airflow
      django_migrate: False
    - django_alias: warehouse
      name: warehouse
      host: pgwarehouse0
      django_migrate: True
    - name: commcarehq_p10
      host: pgshard10
      django_migrate: False
    - name: commcarehq_p11
      host: pgshard11
      django_migrate: False
    - name: commcarehq_p12
      host: pgshard12
      django_migrate: False
    - name: commcarehq_p13
      host: pgshard13
      django_migrate: False
    - name: commcarehq_p14
      host: pgshard14
      django_migrate: False
    - name: commcarehq_p15
      host: pgshard15
      django_migrate: False
    - name: commcarehq_p16
      host: pgshard16
      django_migrate: False
    - name: commcarehq_p17
      host: pgshard17
      django_migrate: False
    - name: commcarehq_p18
      host: pgshard18
      django_migrate: False
    - name: commcarehq_p19
      host: pgshard19
      django_migrate: False
    - name: commcarehq_p20
      host: pgshard20
      django_migrate: False
    - name: commcarehq_p21
      host: pgshard21
      django_migrate: False
    - name: commcarehq_p22
      host: pgshard22
      django_migrate: False
    - name: commcarehq_p23
      host: pgshard23
      django_migrate: False
    - name: commcarehq_p24
      host: pgshard24
      django_migrate: False
    - name: commcarehq_p25
      host: pgshard25
      django_migrate: False
    - name: commcarehq_p26
      host: pgshard26
      django_migrate: False
    - name: commcarehq_p27
      host: pgshard27
      django_migrate: False
    - name: commcarehq_p28
      host: pgshard28
      django_migrate: False
    - name: commcarehq_p29
      host: pgshard29
      django_migrate: False
  standby:
    - django_alias: icds-ucr-standby0
      name: commcarehq_icds_aggregatedata
      host: pgucrstandby0
      create: False
      django_migrate: False
      hq_acceptable_standby_delay: 1800
    - django_alias: icds-ucr-standby1
      name: commcarehq_icds_aggregatedata
      host: pgucrstandby1
      create: False
      django_migrate: False
      hq_acceptable_standby_delay: 1800
    - django_alias: icds-ucr-standby2
      name: commcarehq_icds_aggregatedata
      host: pgucrstandby2
      create: False
      django_migrate: False
      hq_acceptable_standby_delay: 1800
    - django_alias: icds-ucr-standby3
      name: commcarehq_icds_aggregatedata
      host: pgucrstandby3
      create: False
      django_migrate: False
      hq_acceptable_standby_delay: 1800
    - django_alias: pgmainstandby0
      name: commcarehq
      host: pgmainstandby0
      create: False
      django_migrate: False
      hq_acceptable_standby_delay: 0
    - django_alias: pgmainstandby1
      name: commcarehq
      host: pgmainstandby1
      create: False
      django_migrate: False
      hq_acceptable_standby_delay: 0
    - django_alias: pgmainstandby2
      name: commcarehq
      host: pgmainstandby2
      create: False
      django_migrate: False
      hq_acceptable_standby_delay: 0
  logical:
    - name: commcarehq_p10
      host: pgshard10
      master_host: pgshard0
      master_db_name: commcarehq_p1
      replication_set: [0, 51]
    - name: commcarehq_p11
      host: pgshard11
      master_host: pgshard0
      master_db_name: commcarehq_p1
      replication_set: [52, 103]
    - name: commcarehq_p12
      host: pgshard12
      master_host: pgshard1standby
      master_db_name: commcarehq_p2
      replication_set: [104, 154]
    - name: commcarehq_p13
      host: pgshard13
      master_host: pgshard1standby
      master_db_name: commcarehq_p2
      replication_set: [155, 205]
    - name: commcarehq_p14
      host: pgshard14
      master_host: pgshard2
      master_db_name: commcarehq_p3
      replication_set: [206, 257]
    - name: commcarehq_p15
      host: pgshard15
      master_host: pgshard2
      master_db_name: commcarehq_p3
      replication_set: [258, 308]
    - name: commcarehq_p16
      host: pgshard16
      master_host: pgshard3standby
      master_db_name: commcarehq_p4
      replication_set: [309, 360]
    - name: commcarehq_p17
      host: pgshard17
      master_host: pgshard3standby
      master_db_name: commcarehq_p4
      replication_set: [361, 411]
    - name: commcarehq_p18
      host: pgshard18
      master_host: pgshard4
      master_db_name: commcarehq_p5
      replication_set: [412, 463]
    - name: commcarehq_p19
      host: pgshard19
      master_host: pgshard4
      master_db_name: commcarehq_p5
      replication_set: [464, 514]
    - name: commcarehq_p20
      host: pgshard20
      master_host: pgshard5standby
      master_db_name: commcarehq_p6
      replication_set: [515, 566]
    - name: commcarehq_p21
      host: pgshard21
      master_host: pgshard5standby
      master_db_name: commcarehq_p6
      replication_set: [567, 617]
    - name: commcarehq_p22
      host: pgshard22
      master_host: pgshard6
      master_db_name: commcarehq_p7
      replication_set: [618, 669]
    - name: commcarehq_p23
      host: pgshard23
      master_host: pgshard6
      master_db_name: commcarehq_p7
      replication_set: [670, 720]
    - name: commcarehq_p24
      host: pgshard24
      master_host: pgshard7
      master_db_name: commcarehq_p8
      replication_set: [721, 771]
    - name: commcarehq_p25
      host: pgshard25
      master_host: pgshard7
      master_db_name: commcarehq_p8
      replication_set: [772, 823]
    - name: commcarehq_p26
      host: pgshard26
      master_host: pgshard8standby
      master_db_name: commcarehq_p9
      replication_set: [824, 875]
    - name: commcarehq_p27
      host: pgshard27
      master_host: pgshard8standby
      master_db_name: commcarehq_p9
      replication_set: [876, 926]
    - name: commcarehq_p28
      host: pgshard28
      master_host: pgshard9
      master_db_name: commcarehq_p10
      replication_set: [927, 975]
    - name: commcarehq_p29
      host: pgshard29
      master_host: pgshard9
      master_db_name: commcarehq_p10
      replication_set: [976, 1023]
